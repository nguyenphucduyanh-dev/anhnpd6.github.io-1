<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8">
  <title>Quản lý Người dùng</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<div class="container py-4">
  <h3>Quản lý người dùng / khách hàng</h3>
  <div class="mb-3">
    <button class="btn btn-success" onclick="createDemo()">Tạo dữ liệu demo</button>
  </div>
  <table class="table table-striped" id="usersTable">
    <thead><tr><th>Email</th><th>Tên</th><th>Trạng thái</th><th>Hành động</th></tr></thead>
    <tbody></tbody>
  </table>
</div>
<script>
function getUsers(){ return JSON.parse(localStorage.getItem('users')||'[]'); }
function saveUsers(u){ localStorage.setItem('users', JSON.stringify(u)); }
function render(){
  const tbody = document.querySelector('#usersTable tbody'); tbody.innerHTML='';
  getUsers().forEach((user, idx)=>{
    const tr = document.createElement('tr');
    tr.innerHTML = `<td>${user.email}</td><td>${user.name}</td>
      <td>${user.locked? 'Khóa' : 'Hoạt động'}</td>
      <td>
        <button class="btn btn-sm btn-warning" onclick="reset(${idx})">Reset PW</button>
        <button class="btn btn-sm btn-secondary" onclick="toggleLock(${idx})">${user.locked? 'Mở khóa':'Khóa'}</button>
        <button class="btn btn-sm btn-danger" onclick="del(${idx})">Xóa</button>
      </td>`;
    tbody.appendChild(tr);
  });
}
function createDemo(){
  const demo = [
    {email:'kh1@example.com', name:'Nguyễn A', locked:false, password:'1234'},
    {email:'kh2@example.com', name:'Trần B', locked:true, password:'abcd'}
  ];
  saveUsers(demo); render();
  alert('Đã tạo dữ liệu demo');
}
function reset(i){
  const u=getUsers(); u[i].password='password123'; saveUsers(u); render();
  alert('Mật khẩu đã reset thành "password123" (demo).');
}
function toggleLock(i){
  const u=getUsers(); u[i].locked = !u[i].locked; saveUsers(u); render();
}
function del(i){
  if(!confirm('Xác nhận xóa tài khoản?')) return;
  const u=getUsers(); u.splice(i,1); saveUsers(u); render();
}
render();
</script>
</body>
</html>

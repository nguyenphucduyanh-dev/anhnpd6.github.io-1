<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8">
  <title>Quản lý Tồn kho</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<div class="container py-4">
  <h3>Quản lý số lượng tồn</h3>
  <div class="mb-3">
    <button class="btn btn-success" onclick="createDemo()">Tạo demo</button>
  </div>
  <input id="q" class="form-control mb-3" placeholder="Tìm mã sản phẩm hoặc tên" oninput="render()">
  <table class="table"><thead><tr><th>Mã</th><th>Tên</th><th>Tồn</th><th>Hành động</th></tr></thead><tbody id="list"></tbody></table>
</div>
<script>
function getStock(){ return JSON.parse(localStorage.getItem('stock')||'[]'); }
function saveStock(s){ localStorage.setItem('stock', JSON.stringify(s)); }
function render(){
  const q=document.getElementById('q').value.toLowerCase();
  const tbody=document.getElementById('list'); tbody.innerHTML='';
  getStock().filter(it=> it.code.toLowerCase().includes(q) || it.name.toLowerCase().includes(q)).forEach((it,i)=>{
    const tr=document.createElement('tr');
    tr.innerHTML=`<td>${it.code}</td><td>${it.name}</td><td>${it.qty}</td>
      <td><button class="btn btn-sm btn-warning" onclick="adjust(${i})">Điều chỉnh</button></td>`;
    tbody.appendChild(tr);
  });
}
function createDemo(){ saveStock([{code:'C01', name:'Xe A', qty:5},{code:'C02', name:'Xe B', qty:1}]); render(); }
function adjust(i){
  const s=getStock(); const delta = parseInt(prompt('Nhập số (+ nhập, - xuất)', '0'));
  if(isNaN(delta)) return;
  s[i].qty += delta; saveStock(s); render();
  if(s[i].qty<=2) alert('Cảnh báo: sản phẩm sắp hết hàng (<=2).');
}
render();
</script>
</body>
</html>
